---
const { id, title="YouTube video" } = Astro.props;
const thumb = `https://i.ytimg.com/vi/${id}/hqdefault.jpg`;
---
<div class="card" style="position:relative;">
  <button class="ytlite"
    data-id={id}
    aria-label={`Play ${title}`}
    style="all:unset; cursor:pointer; display:block; width:100%;">
    <img src={thumb} alt={title} style="width:100%; aspect-ratio:16/9; object-fit:cover;" />
    <div style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center;">
      <span class="btn" style="pointer-events:none;">â–¶ Play</span>
    </div>
  </button>
</div>

<script>
  document.querySelectorAll(".ytlite").forEach((btn) => {
    btn.addEventListener("click", () => {
      const id = btn.getAttribute("data-id");
      const iframe = document.createElement("iframe");
      iframe.width = "100%";
      iframe.height = "100%";
      iframe.style.aspectRatio = "16/9";
      iframe.src = `https://www.youtube.com/embed/${id}?autoplay=1&rel=0`;
      iframe.title = "YouTube video player";
      iframe.frameBorder = "0";
      iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
      iframe.allowFullscreen = true;

      btn.replaceWith(iframe);
    });
  });
</script>
