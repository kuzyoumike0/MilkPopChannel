---
import BaseLayout from "../layouts/BaseLayout.astro";
import SectionTitle from "../components/SectionTitle.astro";
import YoutubeLite from "../components/YoutubeLite.astro";

import latest from "../data/latest.json";
import lives from "../data/live.json";
import videos from "../data/videos.json";

// ✅ base パス対応ユーティリティ
const base = import.meta.env.BASE_URL;
const join = (p) => new URL(p, `http://x${base}`).pathname;

// 仮ニュース（後で content/news から引く想定）
const news = [
  { title: "新曲MVを公開しました（仮）", date: "2026-02-01", tag: "MV", href: join("/news") },
  { title: "ライブ情報を更新しました（仮）", date: "2026-02-10", tag: "Live", href: join("/live") },
  { title: "新アーティスト写真公開（仮）", date: "2026-02-15", tag: "Media", href: join("/news") }
];
---
<BaseLayout
  title="MilkPop | Official"
  description="MilkPop Official Website"
>

  <!-- HERO -->
  <section class="container" style="padding:18px 0 8px;">
    <div class="card" style="padding:18px; display:grid; gap:16px;">
      <div class="grid cols-2">
        <div>
          <div class="pills" style="margin-bottom:10px;">
            <span class="pill pink">Pop</span>
            <span class="pill sky">Colorful</span>
            <span class="pill lemon">Bright</span>
            <span class="pill mint">Music</span>
          </div>

          <h1 style="margin:0; font-size:38px; font-weight:1000; line-height:1.1;">
            Pastel Pop,<br />
            Make Your Day Shine.
          </h1>

          <p class="small" style="margin:12px 0 18px;">
            MilkPopの世界へようこそ。<br />
            最新MV・ライブ・ニュースをまとめてチェック。
          </p>

          <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <a
              class="btn"
              href={`https://www.youtube.com/watch?v=${latest.youtubeId}`}
              target="_blank"
              rel="noreferrer"
            >
              Latest MV
            </a>

            <a class="btn" href={join("/discography")}>
              Listen
            </a>

            <a class="btn" href={join("/live")}>
              Live
            </a>
          </div>
        </div>

        <div>
          <img
            src={join("/img/kv.jpg")}
            alt="Key Visual (placeholder)"
            style="
              border-radius:20px;
              border:1px solid var(--line);
              box-shadow:var(--shadow);
              aspect-ratio:16/10;
              object-fit:cover;
            "
          />
        </div>
      </div>
    </div>
  </section>

  <!-- LATEST MV -->
  <section class="section">
    <div class="container">
      <SectionTitle en="LATEST" ja="最新MV" color="sky" />
      <YoutubeLite id={latest.youtubeId} title={latest.title} />
    </div>
  </section>

  <!-- NEWS -->
  <section class="section">
    <div class="container">
      <SectionTitle en="NEWS" ja="お知らせ" color="pink" />

      <div class="grid cols-3">
        {news.map((n, i) => (
          <a class="card" href={n.href} style="padding:14px;">
            <div class="pills" style="margin-bottom:10px;">
              <span class={`pill ${i % 2 === 0 ? "lemon" : "mint"}`}>
                {n.tag}
              </span>
              <span class="small">{n.date}</span>
            </div>

            <div style="font-weight:900; line-height:1.3;">
              {n.title}
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- LIVE -->
  <section class="section">
    <div class="container">
      <SectionTitle en="LIVE" ja="ライブ / スケジュール" color="mint" />

      <div class="grid cols-2">
        {lives.slice(0, 2).map((l) => (
          <a
            class="card"
            href={l.url}
            target="_blank"
            rel="noreferrer"
            style="padding:16px;"
          >
            <div class="pills" style="margin-bottom:10px;">
              <span class="pill mint">Next</span>
              <span class="small">{l.date}</span>
            </div>

            <div style="font-weight:1000; font-size:18px;">
              {l.title}
            </div>

            <div class="small">{l.venue}</div>
          </a>
        ))}

        <div class="card" style="padding:16px;">
          <div style="font-weight:1000;">もっと見る</div>
          <p class="small" style="margin:8px 0 0;">
            過去公演も含めて一覧表示します。
          </p>
          <hr class="sep" />
          <a class="btn" href={join("/live")}>
            Go to Live
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- VIDEOS -->
  <section class="section">
    <div class="container">
      <SectionTitle en="VIDEOS" ja="動画" color="lemon" />

      <div class="grid cols-3">
        {videos.slice(0, 3).map((v) => (
          <YoutubeLite id={v.youtubeId} title={v.title} />
        ))}
      </div>
    </div>
  </section>

</BaseLayout>
